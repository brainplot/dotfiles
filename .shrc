#!/bin/sh

gpg_tty="$(tty)" && export GPG_TTY="$gpg_tty"
unset gpg_tty

case "$TERM" in
	xterm*|screen*|linux)
		export EDITOR=nvim
		export VISUAL="$EDITOR"
		;;
esac

case "$TERM" in
	xterm-*color|screen-*color|tmux-*color)
		export CLICOLOR=1
		;;
esac

alias la='ls -lhA'
alias ll='ls -lh'
alias ls='ls --color=auto'
alias grep='grep --color=auto'
alias tree="tree -I '.git|.hg|.svn'"
alias bashconfig='"$EDITOR" "$HOME"/.bashrc'
alias zshconfig='"$EDITOR" "$HOME"/.zshrc'
alias nvimconfig="nvim -c 'edit \$MYVIMRC'"
alias nvimsync="nvim --headless -c 'autocmd User PackerComplete quitall' -c PackerSync"
alias gitconfig='git config --global -e'
alias tmuxconfig='"$EDITOR" "$XDG_CONFIG_HOME"/tmux/tmux.conf'
alias dot='git --git-dir="$HOME/.dot.git" --work-tree="$HOME"'

# Disable blinking cursor if running in Windows Terminal
[ -n "$WT_SESSION" ] && printf '\e[2 q'

# Functions
source_aws_credentials_from_csv() {
	if [ "$#" -lt 1 ]
	then
		echo fatal: no CSV file provided >&2
	else
		eval "$(awk -F, 'FNR==2 { printf "export AWS_ACCESS_KEY_ID=%s AWS_SECRET_ACCESS_KEY=%s", $3, $4 }' "$1")"
	fi
}

renumber() {
	new_number="$(printf '%02d' "$2")"
	file_wo_number="${1#*.}"
	if [ "$1" != "$file_wo_number" ]
	then
		mv -v -- "$1" "$new_number"."$file_wo_number"
	fi
}
